# 【go程序】bytes.Buffer在http客户端中的坑

## 引子

将bytes.Buffer中的内容通过http发送出去，然后查看bytes.Buffer中的内容。代码如下：
   
<!--break-->
    
    package main
    import (
        "fmt"
        "bytes"
        "net/http"
    )
    
    func main() {
        var buf bytes.Buffer
        buf.Write([]byte("hello world"))
        fmt.Println("buf before http:"， buf.String())
        client := &http.Client{}
        req, err := http.NewRequest("POST", "http://127.0.0.1:12345/test", &buf)
        _, err = client.Do(req)
        if err != nil {
            panic(err)
        }
        fmt.Println("buf after http:", buf.String())
    }

运行程序输出如下：

```
buf before http: hello world
buf after http:
```

可以看出，在`http.NewRequest`操作buf之后，整个buf的内容变为空。如果随后我们还继续使用这个buf中的内容的话，必然会发生意想不到的错误。